---
title: "Project"
output: html_document
date: "2023-12-12"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```






















# Data Pre-processing

```{r,results='markup'}
data= read.csv('DataCoSupplyChainDataset.csv')
head(data)
```


```{r,results='markup'}
str(data)
```


```{r,results='markup'}
dim(is.na(data))
```


```{r,results='markup'}
data$`Customer.Full.Name` <- paste(data$`Customer.Fname`, data$`Customer.Lname`)
```
```{r,results='markup'}
colSums(is.na(data))
```

```{r,results='markup'}
data[1, ]

```

```{r,results='markup'}
data$Customer.Email <- NULL
data$Customer.Password <- NULL
data$Order.Zipcode <-NULL
data$Product.Description <- NULL
data$Product.Image<-NULL
data$order.date..DateOrders. <- NULL
data$shipping.date..DateOrders.<- NULL
data$Customer.Fname <- NULL
data$Customer.Lname <- NULL
data$Product.Status <-NULL
data$Customer.Street <- NULL
data$Latitude<- NULL
data$Longitude <- NULL
```

```{r,results='markup'}
data[1,]
```

```{r,results='markup'}
colSums(is.na(data))
```

```{r,results='markup'}
data <- na.omit(data)
```

```{r,results='markup'}
dim(data)
```

```{r,results='markup'}
str(data)
```

```{r,results='markup'}
unique_values_count <- sapply(data, function(x) length(unique(x)))
unique_values_count
```


```{r,results='markup'}
colnames(data)
```

```{r,results='markup'}
data$Type <- as.factor(data$Type)
data$Delivery.Status <- as.factor(data$Delivery.Status)
data$Late_delivery_risk <- as.factor(data$Late_delivery_risk)
data$Category.Id <- as.factor(data$Category.Id)
data$Category.Name <- as.factor(data$Category.Name)
data$Customer.City <- as.factor(data$Customer.City)
data$Customer.Country <- as.factor(data$Customer.Country)
data$Customer.Fname <- as.factor(data$Customer.Fname)
data$Customer.Lname <- as.factor(data$Customer.Lname)
data$Customer.Segment <- as.factor(data$Customer.Segment)
data$Customer.State <- as.factor(data$Customer.State)
data$Department.Id <- as.factor(data$Department.Id)
data$Department.Name <- as.factor(data$Department.Name)
data$Market <- as.factor(data$Market)
data$Order.City <- as.factor(data$Order.City)
data$Order.Country <- as.factor(data$Order.Country)
data$Order.Region <- as.factor(data$Order.Region)
data$Order.State <- as.factor(data$Order.State)
data$Order.Status <- as.factor(data$Order.Status)
data$Product.Card.Id <- as.factor(data$Product.Card.Id)
data$Product.Category.Id <- as.factor(data$Product.Category.Id)
data$Product.Name <- as.factor(data$Product.Name)
data$Shipping.Mode <- as.factor(data$Shipping.Mode)
```



```{r,results='markup'}
sapply(data, class)
```

```{r,results='markup'}
value_counts <- table(data$Late_delivery_risk)
value_counts
```



```{r,results='markup'}
data[1,]
```
```{r,results='markup'}
Days.for.shipping..real.,Days.for.shipment..scheduled.,Benefit.per.order,Sales.per.customer,Order.Item.Discount,
Order.Item.Discount.Rate,Order.Item.Product.Price,Order.Item.Profit.Ratio,Order.Item.Quantity,Sales,Order.Item.Total,Order.Profit.Per.Order,Product.Price.



```
# EDA


```{r,results='markup'}
library(ggplot2)

custom_colors <- c("#004c6d", "#005b8f", "#0072b2", "#0088d2", "#009fdd")


par(mar = c(5, 5, 4, 2))


category_counts <- table(data$Type)
percentage <- round((category_counts / sum(category_counts)) * 100, 2)

# Create labels with percentages
labels_with_percentage <- paste(names(category_counts), "\n", format(percentage, nsmall = 2), "%", sep = "")


pie(category_counts,
    labels = labels_with_percentage,

    col = custom_colors,
    cex = 0.8,
    init.angle = 90, 
    border = "white" 
)


legend("topright",
       legend = names(category_counts),
       fill = custom_colors,
       cex = 0.8, 
       bty = "n"
)

title(main = "Distribution of Payment Methods", cex.main = 2)

```


```{r, results='markup'}

library(dplyr)
total_sales_per_category <- data %>%
  group_by(Category.Name) %>%
  summarize(Total.Sales = sum(Sales)) %>%
  arrange(desc(Total.Sales))


top_10_categories <- head(total_sales_per_category, 10)


ggplot(top_10_categories, aes(x = reorder(Category.Name, Total.Sales), y = Total.Sales / 1e6)) + 
  geom_bar(stat = "identity", fill = "steelblue") +
  coord_flip() + 
  labs(title = "Top Performers: Highest-Selling Product Categories",
       x = "Categories",
       y = "Total Sales (in Millions)") +
  theme_minimal() +
  theme(axis.text.y = element_text(angle = 0, hjust = 1)) + 
  scale_y_continuous(breaks = c(0, 2, 4, 6), labels = c("0", "2", "4", "6")) 
```



#Model Building

```{r,results='markup'}
train_data <- data
```












